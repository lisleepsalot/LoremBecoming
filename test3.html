<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Looping Div Grid</title>
  <style>
    /* Global styling for all divs */
    div {
      background: white;
      border: 1px solid black;
      padding: 2px;
      box-sizing: border-box;
    }
    /* A fixed counter display */
    #counter {
      position: fixed;
      top: 0;
      left: 0;
      background: #eee;
      padding: 2px;
      font-weight: bold;
      z-index: 1000;
    }
    /* Ensure the body takes full height */
    html, body {
      margin: 0;
    }
    @media print {
  html, body {
    width: auto;
    overflow: visible;
  }

  /* Optional: target specific elements */
  .your-container {
    width: 100%;
    overflow: visible;
  }
}
  </style>
</head>
<body>
  <!-- The counter display -->
  <div id="counter">Round Count: 0</div>
  
  <script>
    // Global counter for rounds
    let roundCount = 0;
    
    // Update the counter display
    function updateCounter() {
      document.getElementById('counter').textContent = "Round Count: " + roundCount;
    }
    
    // Create a grid inside the given parent element
    function createGrid(parent) {
      // Random rows between 1 and 3, columns between 2 and 5
      const rows = Math.floor(Math.random() * 3) + 1;
      const cols = Math.floor(Math.random() * 4) + 2;
      // Random number of new divs between 2 and 8
      const numNewDivs = Math.floor(Math.random() * 7) + 2;
      
      // Set up the parent as a CSS grid container
      parent.style.display = "grid";
      parent.style.gridTemplateRows = `repeat(${rows}, 1fr)`;
      parent.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
      parent.style.gap = "5px";
      
      const newDivs = [];
      for (let i = 0; i < numNewDivs; i++) {
        const newDiv = document.createElement("div");
        // Set initial blue background and smooth transition for background color
        newDiv.style.background = "blue";
        newDiv.style.transition = "background-color 0.3s ease-out";
        
        parent.appendChild(newDiv);
        
        newDivs.push(newDiv);
        
        // After 300ms, fade the background to white
        setTimeout(() => {
          newDiv.style.background = "white";
        }, 300);
      }
      return newDivs;
    }
    
    // Global array of parent elements; start with body
    let parents = [document.body];
    
    // New function to iterate grid creation every 0.3 seconds
    function iterateGrids() {
      if (roundCount >= 6) {
        clearInterval(interval);
        return;
      }
      let nextParents = [];
      for (const parent of parents) {
        const newDivs = createGrid(parent);
        nextParents.push(...newDivs);
      }
      if (nextParents.length === 0) {
        clearInterval(interval);
        return;
      }
      parents = nextParents;

      roundCount++;
      updateCounter();
    }
    
    // Start the iterative process every 0.3 seconds
    const interval = setInterval(iterateGrids, 1000);
  </script>
</body>
</html>